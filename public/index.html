<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ShopIt Website</title>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js" 
    ></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.0/socket.io.min.js'></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    
    <div id = "v-app">
        <div class="overlay" v-if="loading">
            <div class="overlay__inner">
                <div class="overlay__content"><span class="spinner"></span></div>
            </div>
        </div>
        <h3>{{ title }}</h3>
        <h5>Query URL => {{queryURL}}</h5>

        <div class="w3-clear nextprev margin-down">
            <button class="w3-left w3-btn"  @click="handleShowOrders()">Show Orders</button>
            <button class="w3-right w3-btn"  @click="handleShowCart()">Show Cart</button>
        </div>
        <div class="notification-popup no-print" v-if="newOrderPlacedFlag">
            Order Was placed from: {{newOrderPlaced.urlOfSale}}
            <span>Bought: {{newOrderPlaced.productIds.join()}}</span>
            <span>Price: {{newOrderPlaced.price}} - {{newOrderPlaced.currency}}</span>

            <div class="actions">    
                <button mat-button="" class="mat-focus-indicator mat-button mat-button-base" @click="closePopup()"><span class="mat-button-wrapper"> OK, got it </span>
                    <span matripple="" class="mat-ripple mat-button-ripple"></span><span class="mat-button-focus-overlay"></span>
                </button>
            </div>
        </div>
        <div class="productplaced-popup no-print" v-if="newProductPlaced">
            Order placed!
        </div>
        <div class="productplaced-popup no-print" v-if="orderPlaceFailed">
            Order placing failed!
            {{errorMessage}}
        </div>
        <div class="container" v-if="showCart">
            <div class="heading">
                <h1>Shopping Cart</h1>
            </div>
            
            <div class="cart transition is-open">
                <div class="table">
                    <div class="layout-inline row th">
                        <div class="col col-pro">Product</div>
                        <div class="col col-price align-center "> 
                        Price
                        </div>
                        <div class="col">URL</div>
                    </div>
                
                    <div class="layout-inline row"
                        v-bind:class="{ 'row-bg2': index % 2 == 0 }"
                        v-for="(product, index) in products">
                        
                        <div class="col col-pro layout-inline">
                          <img v-bind:src="product.img" alt="product.alt" />
                          <p>{{product.productName}}</p>
                        </div>
                        
                        <div class="col col-price col-numeric align-center ">
                          <p>{{product.price}} {{product.currency}}</p>
                        </div>
            
                        <div class="col col-vat col-numeric">
                          <p>{{product.urlOfSale}}</p>
                        </div>
                        <div class="col col col-numeric">
                          <button class="btn" @click="placeOrder(product, index)">Place Order</a>
                        </div>
                        
                    </div>    
                </div>
           </div>
            
       </div>

       <div class="container" v-if="showOrders">
            <div class="heading">
                <h1>Orders</h1>
            </div>
            
            <div class="cart transition is-open">
                <div class="table">
                    <div class="layout-inline row th">
                        <div class="col-order">Order Id</div>
                        <div class="col-order">Product</div>
                        <div class="col-order price"> 
                        Price
                        </div>
                        <div class="col-url">URL</div>
                        <div class="col-order">Order Date</div>
                    </div>
                
                    <div class="layout-inline row"
                        v-bind:class="{ 'row-bg2': index % 2 == 0 }"
                        v-for="(order, index) in orders">
                        <div class="col-order layout-inline">
                           <p>{{order.orderId}}</p>
                        </div>
                        <div class="col-order layout-inline">
                          <p>{{order.productIds.join()}}</p>
                        </div>
                        
                        <div class="col-order price">
                          <p>{{order.price}} {{order.currency}}</p>
                        </div>
            
                        <div class="col-url">
                          <p>{{order.urlOfSale}}</p>
                        </div>   
                        <div class="col-order">
                          <p>{{order.orderDate}}</p>
                        </div>                        
                    </div>    
                </div>
                <div class="w3-clear nextprev">
                    <button class="w3-left w3-btn" v-bind:class="{ disabled: disablePrevBtn === true }" @click="loadPrevious()">❮ Previous</button>
                    <button class="w3-right w3-btn" @click="loadNext()">Next ❯</button>
                </div>
           </div>
            
       </div>
    </div>
    <script src="app.js"></script>
</body>
</html>